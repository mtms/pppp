<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Psycho Magic</title>
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="viewport"  content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1" />

	<!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
	<!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
	<!--script src="js/less-1.3.3.min.js"></script-->
	<!--append ‘#!watch’ to the browser URL, then refresh the page. -->
	
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">
  <link href="css/video-js.min.css" rel="stylesheet">


  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" href="img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="img/favicon.png">
  
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/scripts.js"></script>
	<script type="text/javascript" src="js/video.js"></script>
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    
     <script type="text/javascript" charset="utf-8">  
		
		 	function onLoad() {
        		document.addEventListener("deviceready", onDeviceReady, false);
			}

			// device APIs are available
			//
			//function onDeviceReady() {
			//	navigator.splashscreen.hide();
             //   cordova.exec(null, null, "SplashScreen", "hide", []);
			//}
		
		$( document ).ready(function() {
				var play=false;
                var souldPlay=false;
                var playingEnglish=false;
				var myPlayer = videojs('ml_video');
                var EnPlayer=videojs('en_video');
                var count=0;
                var mark=0;

				function secondToMinutes(millis) {
					minutes = Math.floor(millis / 60);
					seconds = millis % 60;
					return minutes + "." + seconds.toFixed(0);
				}
            
			     myPlayer.on('pause', function(){
                    
                        setTimeout(function(){
                            if(souldPlay==true){
                                if(playingEnglish==true){
                                    EnPlayer.play();
                                }else{
                                    myPlayer.play();
                                }
                            }
                        }, 3000);
                        
                        
                   
                 });
			
				myPlayer.on('timeupdate', function(){
					switch(secondToMinutes(myPlayer.currentTime())){
						case "0.33": 
							$('#nameform').removeClass('hidden');
							break;
						case "0.36": 
							if(play){
                                souldPlay=false;
								myPlayer.pause();
								$("#nameform").children("input").focus();
							}
							break;
						case "0.40": 
							$('#emailform').removeClass('hidden');
							play=true;
							break;
						case "0.51": 
							if(play){
                                souldPlay=false;
								myPlayer.pause();
								$("#emailform").children("input").focus();
							}
							break;
						case "6.0": 
							$('#answerform').removeClass('hidden');
							play=true;
							break;
						case "6.7": 
							if(play){
                                souldPlay=false;
								myPlayer.pause();
							}
							break;
						case "8.3": 
							$('#answerform').removeClass('hidden');
							play=true;
							break;
						case "8.8": 
							if(play){
                                souldPlay=false;
								myPlayer.pause();
							}
							break;
						case "11.30": 
							$('#answerform').removeClass('hidden');
							play=true;
							break;
						case "11.34": 
							if(play){
                                souldPlay=false;
								myPlayer.pause();
							}
							break;
						
					}
				});
            
                EnPlayer.on('timeupdate', function(){
					switch(secondToMinutes(EnPlayer.currentTime())){
						case "0.33": 
							$('#nameform').removeClass('hidden');
							break;
						case "0.36": 
							if(play){
                                souldPlay=false;
								EnPlayer.pause();
								$("#nameform").children("input").focus();
							}
							break;
						case "0.39": 
							$('#emailform').removeClass('hidden');
							play=true;
							break;
						case "0.49": 
							if(play){
                                souldPlay=false;
								EnPlayer.pause();
								$("#emailform").children("input").focus();
							}
							break;
						case "6.29": 
							$('#answerform').removeClass('hidden');
							play=true;
							break;
						case "6.33": 
							if(play){
                                souldPlay=false;
								EnPlayer.pause();
							}
							break;
						case "8.42": 
							$('#answerform').removeClass('hidden');
							play=true;
							break;
						case "8.45": 
							if(play){
                                souldPlay=false;
								EnPlayer.pause();
							}
							break;
						case "12.23": 
							$('#answerform').removeClass('hidden');
							play=true;
							break;
						case "12.28": 
							if(play){
                                souldPlay=false;
								EnPlayer.pause();
							}
							break;
						
					}
				});
            
				$('#btn_ml').click(function(){
						$('#first_page').hide();
						myPlayer.dimensions( document.body.clientWidth,document.body.clientHeight );
						$('#ml_video').removeClass('hidden');
						myPlayer.play();
						play=true;
                        playingEnglish=false;
                        souldPlay=true;

				});
                $('#btn_en').click(function(){
						$('#first_page').hide();
						EnPlayer.dimensions( document.body.clientWidth,document.body.clientHeight );
						$('#en_video').removeClass('hidden');
						EnPlayer.play();
						play=true;
                        playingEnglish=true;
                        souldPlay=true;

				});
            
				$('#nameform_save_btn').click(function(){
							play=false;
                            souldPlay=true;
							if (!playingEnglish){
                                myPlayer.play();
                            }else{
                                EnPlayer.play();
                            }
							$('#nameform').addClass('hidden');
						
				});
			
				$('#emailform_save_btn,#emailform_skip_btn').click(function(){
						play=false;
                        souldPlay=true;
						if (!playingEnglish){
                                myPlayer.play();
                            }else{
                                EnPlayer.play();
                            }
						$('#emailform').addClass('hidden');
				});
			
				$('#answerform_skip_btn').click(function(){
						play=false;
                        souldPlay=true;
                        count=count+1;
						if (!playingEnglish){
                                myPlayer.play();
                            }else{
                                EnPlayer.play();
                            }
						$('#answerform').addClass('hidden');
                     sendMail();
				});
                $('#answerform_save_btn').click(function(){
						play=false;
                        souldPlay=true;
                        count=count+1;
                        mark=mark+1;
						if (!playingEnglish){
                                myPlayer.play();
                            }else{
                                EnPlayer.play();
                            }
						$('#answerform').addClass('hidden');
                        sendMail();
                    
				});
            
			function sendMail(){
                 if(count>2){
                        var mail=$('#emailform').children('input').val();
                        var names=$('#nameform').children('input').val();
                        var url= encodeURI('http://192.168.1.253/mail/?id=' + mail +'&mark='+ mark +'&name='+  names);
                        $.ajax({
                          type: 'GET',
                          url:url ,
                          xhrFields: {
                            withCredentials: false
                          },
                        });
                        if (!playingEnglish){
                                myPlayer.stop();
                            }else{
                                EnPlayer.stop();
                            }
                     navigator.app.exitApp();
                    }
            }
		});
         
         
		
	</script>

</head>

<body style="background-color: #121212;" onload="onLoad()">
	<div id="first_page" class="container">
		<div class="row clearfix">
			<div class="col-md-4 column">
			</div>
			<div class="col-md-4 column">
				<div class="row clearfix">
					<div class="col-md-12 column">
						<img alt="Magicplanet" src="img/logo.png" style="margin-left: -50px;padding-top: 50px;" />
					</div>
				</div>
				<div class="row clearfix" style="padding-top: 80px">
					<div class="col-md-6 text-center">
						 <button id="btn_en" type="button" class="btn btn-lg btn-block btn-success" style="min-width=100px">English</button>
					</div>
					<div class="col-md-6 text-center">
						 <button id="btn_ml" type="button" class="btn btn-success btn-lg btn-block">മലയാളം</button>
					</div>

				</div>
			</div>
			<div class="col-md-4 column">
			</div>
		</div>
	</div>
	<video id="en_video" class="hidden video-js vjs-default-skin"  data-setup="{}">
		<source src="http://192.168.1.253/video/en.mp4" type='video/mp4'>
		<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>
	</video>
	<video id="ml_video" class="hidden video-js vjs-default-skin"  data-setup="{}" >
		<source src="http://192.168.1.253/video/ml.mp4" type='video/mp4'>
		<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>
	</video>
	<div class="hidden" id="nameform">
			<input type="text" class="inputname" >
			<button class="save_btn" id="nameform_save_btn">Submit</button>
	</div>
	<div class="hidden" id="emailform">
			<input type="email" class="inputname">
			<button class="save_btn" id="emailform_save_btn">Submit</button>
			<button class="skip_btn" id="emailform_skip_btn">Skip</button>
	</div>
	<div class="hidden" id="answerform">
			<button class="save_btn big icon-thumbs-up" id="answerform_save_btn"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
			<button class="skip_btn big" id="answerform_skip_btn"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
	</div>
 </body>
   
</html>
